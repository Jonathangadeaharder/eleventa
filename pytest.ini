[pytest]
testpaths = tests
python_files = test_*.py *_test.py
python_classes = Test* *Test *TestCase *Tests
python_functions = test_* *_test

# Core options
addopts = --cov=core --cov-report=html --cov-report=term
          -k "not ui"
          -v

# Markers
markers =
    unit: Unit tests
    integration: Integration tests
    ui: UI tests requiring Qt
    smoke: Smoke tests
    alembic: Database migration tests

# Qt settings
qt_api = pyside6

# Logging
log_cli = true
log_cli_level = INFO

# Filter warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

# For parallel execution, add this option when needed:
# -n auto

# Timeout settings
timeout = 10.0
timeout_method = thread

# Set console output options
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s:%(filename)s:%(lineno)s - %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Common test commands (for documentation)
# pytest                 - Run all non-UI tests
# pytest --ui            - Run all tests including UI tests
# pytest -m unit         - Run only unit tests
# pytest -m integration  - Run only integration tests
# pytest tests/unit      - Run tests in the unit directory
# pytest -k "not ui"     - Explicitly exclude UI tests

[coverage:run]
source =
    core
    ui
omit =
    tests/*
    venv/*

[coverage:report]
# Fail if coverage drops below 80%
#fail_under = 80
show_missing = True

# Add option for ui tests
# To run UI tests: pytest -k ui
